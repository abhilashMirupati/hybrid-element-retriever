<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shadow DOM and Web Components - Real World Example</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #f0f2f5;
            padding: 40px;
            margin: 0;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            color: #1c1e21;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Custom Web Components Demo</h1>
        
        <div class="card">
            <h2>User Profile Component</h2>
            <user-profile 
                name="Jane Smith" 
                role="Senior Developer"
                avatar="JS">
            </user-profile>
        </div>
        
        <div class="card">
            <h2>Custom Input Component</h2>
            <custom-input 
                label="Email Address" 
                placeholder="Enter your email"
                type="email"
                required="true">
            </custom-input>
        </div>
        
        <div class="card">
            <h2>Nested Shadow DOM - Card with Actions</h2>
            <action-card 
                title="Project Alpha"
                description="A revolutionary new product that will change everything">
            </action-card>
        </div>
        
        <div class="card">
            <h2>Custom Date Picker</h2>
            <date-picker 
                label="Select Date"
                min="2024-01-01"
                max="2024-12-31">
            </date-picker>
        </div>
    </div>
    
    <script>
        // User Profile Component
        class UserProfile extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
            }
            
            connectedCallback() {
                const name = this.getAttribute('name') || 'Unknown User';
                const role = this.getAttribute('role') || 'No Role';
                const avatar = this.getAttribute('avatar') || '??';
                
                this.shadowRoot.innerHTML = `
                    <style>
                        .profile {
                            display: flex;
                            align-items: center;
                            padding: 15px;
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            border-radius: 8px;
                            color: white;
                        }
                        
                        .avatar {
                            width: 60px;
                            height: 60px;
                            border-radius: 50%;
                            background: rgba(255, 255, 255, 0.2);
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 24px;
                            font-weight: bold;
                            margin-right: 20px;
                        }
                        
                        .info {
                            flex: 1;
                        }
                        
                        .name {
                            font-size: 20px;
                            font-weight: 600;
                            margin-bottom: 5px;
                        }
                        
                        .role {
                            font-size: 14px;
                            opacity: 0.9;
                        }
                        
                        .edit-btn {
                            padding: 8px 16px;
                            background: rgba(255, 255, 255, 0.2);
                            border: 1px solid rgba(255, 255, 255, 0.3);
                            color: white;
                            border-radius: 4px;
                            cursor: pointer;
                            transition: background 0.2s;
                        }
                        
                        .edit-btn:hover {
                            background: rgba(255, 255, 255, 0.3);
                        }
                    </style>
                    
                    <div class="profile">
                        <div class="avatar">${avatar}</div>
                        <div class="info">
                            <div class="name">${name}</div>
                            <div class="role">${role}</div>
                        </div>
                        <button class="edit-btn" id="editProfile">Edit Profile</button>
                    </div>
                `;
                
                this.shadowRoot.getElementById('editProfile').addEventListener('click', () => {
                    alert(`Editing profile for ${name}`);
                });
            }
        }
        
        // Custom Input Component
        class CustomInput extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
            }
            
            connectedCallback() {
                const label = this.getAttribute('label') || 'Input';
                const placeholder = this.getAttribute('placeholder') || '';
                const type = this.getAttribute('type') || 'text';
                const required = this.getAttribute('required') === 'true';
                
                this.shadowRoot.innerHTML = `
                    <style>
                        .input-group {
                            margin: 10px 0;
                        }
                        
                        label {
                            display: block;
                            margin-bottom: 8px;
                            color: #555;
                            font-weight: 500;
                        }
                        
                        input {
                            width: 100%;
                            padding: 10px;
                            border: 2px solid #e0e0e0;
                            border-radius: 4px;
                            font-size: 16px;
                            transition: border-color 0.3s;
                        }
                        
                        input:focus {
                            outline: none;
                            border-color: #667eea;
                        }
                        
                        input:valid {
                            border-color: #27ae60;
                        }
                        
                        input:invalid:not(:placeholder-shown) {
                            border-color: #e74c3c;
                        }
                        
                        .helper-text {
                            margin-top: 5px;
                            font-size: 12px;
                            color: #999;
                        }
                    </style>
                    
                    <div class="input-group">
                        <label for="custom-input">${label}${required ? ' *' : ''}</label>
                        <input 
                            id="custom-input"
                            type="${type}" 
                            placeholder="${placeholder}"
                            ${required ? 'required' : ''}
                        >
                        <div class="helper-text">This is a custom input component</div>
                    </div>
                `;
                
                const input = this.shadowRoot.getElementById('custom-input');
                input.addEventListener('input', (e) => {
                    this.dispatchEvent(new CustomEvent('custom-input', {
                        detail: { value: e.target.value }
                    }));
                });
            }
        }
        
        // Action Card Component (Nested Shadow DOM)
        class ActionCard extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
            }
            
            connectedCallback() {
                const title = this.getAttribute('title') || 'Untitled';
                const description = this.getAttribute('description') || '';
                
                this.shadowRoot.innerHTML = `
                    <style>
                        .card {
                            border: 1px solid #e0e0e0;
                            border-radius: 8px;
                            padding: 20px;
                            background: white;
                        }
                        
                        .title {
                            font-size: 18px;
                            font-weight: 600;
                            margin-bottom: 10px;
                            color: #333;
                        }
                        
                        .description {
                            color: #666;
                            margin-bottom: 20px;
                            line-height: 1.5;
                        }
                        
                        .actions {
                            display: flex;
                            gap: 10px;
                        }
                    </style>
                    
                    <div class="card">
                        <div class="title">${title}</div>
                        <div class="description">${description}</div>
                        <div class="actions">
                            <action-button type="primary" text="View Details"></action-button>
                            <action-button type="secondary" text="Share"></action-button>
                            <action-button type="danger" text="Delete"></action-button>
                        </div>
                    </div>
                `;
            }
        }
        
        // Action Button Component (Nested within Action Card)
        class ActionButton extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
            }
            
            connectedCallback() {
                const type = this.getAttribute('type') || 'primary';
                const text = this.getAttribute('text') || 'Click';
                
                const colors = {
                    primary: '#3498db',
                    secondary: '#95a5a6',
                    danger: '#e74c3c'
                };
                
                this.shadowRoot.innerHTML = `
                    <style>
                        button {
                            padding: 8px 16px;
                            background: ${colors[type]};
                            color: white;
                            border: none;
                            border-radius: 4px;
                            cursor: pointer;
                            font-size: 14px;
                            transition: opacity 0.2s;
                        }
                        
                        button:hover {
                            opacity: 0.9;
                        }
                        
                        button:active {
                            transform: scale(0.98);
                        }
                    </style>
                    
                    <button>${text}</button>
                `;
                
                this.shadowRoot.querySelector('button').addEventListener('click', () => {
                    console.log(`${type} button clicked: ${text}`);
                    this.dispatchEvent(new CustomEvent('action-click', {
                        detail: { type, text },
                        bubbles: true,
                        composed: true
                    }));
                });
            }
        }
        
        // Date Picker Component
        class DatePicker extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: 'open' });
            }
            
            connectedCallback() {
                const label = this.getAttribute('label') || 'Date';
                const min = this.getAttribute('min') || '';
                const max = this.getAttribute('max') || '';
                
                this.shadowRoot.innerHTML = `
                    <style>
                        .date-picker {
                            margin: 10px 0;
                        }
                        
                        label {
                            display: block;
                            margin-bottom: 8px;
                            color: #555;
                            font-weight: 500;
                        }
                        
                        .input-wrapper {
                            position: relative;
                            display: inline-block;
                        }
                        
                        input[type="date"] {
                            padding: 10px;
                            border: 2px solid #e0e0e0;
                            border-radius: 4px;
                            font-size: 16px;
                            min-width: 200px;
                            transition: border-color 0.3s;
                        }
                        
                        input[type="date"]:focus {
                            outline: none;
                            border-color: #667eea;
                        }
                        
                        .calendar-icon {
                            position: absolute;
                            right: 10px;
                            top: 50%;
                            transform: translateY(-50%);
                            pointer-events: none;
                            color: #999;
                        }
                        
                        .selected-date {
                            margin-top: 10px;
                            padding: 10px;
                            background: #f0f0f0;
                            border-radius: 4px;
                            display: none;
                        }
                        
                        .selected-date.show {
                            display: block;
                        }
                    </style>
                    
                    <div class="date-picker">
                        <label>${label}</label>
                        <div class="input-wrapper">
                            <input 
                                type="date" 
                                id="date-input"
                                ${min ? `min="${min}"` : ''}
                                ${max ? `max="${max}"` : ''}
                            >
                            <span class="calendar-icon">📅</span>
                        </div>
                        <div class="selected-date" id="selected-date"></div>
                    </div>
                `;
                
                const input = this.shadowRoot.getElementById('date-input');
                const display = this.shadowRoot.getElementById('selected-date');
                
                input.addEventListener('change', (e) => {
                    const date = new Date(e.target.value);
                    const formatted = date.toLocaleDateString('en-US', {
                        weekday: 'long',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    
                    display.textContent = `Selected: ${formatted}`;
                    display.classList.add('show');
                    
                    this.dispatchEvent(new CustomEvent('date-selected', {
                        detail: { date: e.target.value, formatted }
                    }));
                });
            }
        }
        
        // Register all custom elements
        customElements.define('user-profile', UserProfile);
        customElements.define('custom-input', CustomInput);
        customElements.define('action-card', ActionCard);
        customElements.define('action-button', ActionButton);
        customElements.define('date-picker', DatePicker);
        
        // Add global event listener for nested shadow DOM events
        document.addEventListener('action-click', (e) => {
            console.log('Action clicked from shadow DOM:', e.detail);
        });
        
        document.addEventListener('custom-input', (e) => {
            console.log('Input value changed:', e.detail.value);
        });
        
        document.addEventListener('date-selected', (e) => {
            console.log('Date selected:', e.detail);
        });
    </script>
</body>
</html>