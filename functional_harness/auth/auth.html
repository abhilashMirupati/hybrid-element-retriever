<!DOCTYPE html>
<html>
<head>
    <title>Authentication Flow Test</title>
    <style>
        .auth-container {
            max-width: 400px;
            margin: 50px auto;
            padding: 30px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .form-group {
            margin: 20px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            width: 100%;
            padding: 12px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #1976d2;
        }
        .error {
            color: #f44336;
            margin-top: 10px;
        }
        .success {
            color: #4caf50;
            margin-top: 10px;
        }
        .mfa-section {
            display: none;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 1px solid #ddd;
        }
        .redirect-message {
            text-align: center;
            color: #666;
            margin: 20px 0;
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <!-- Login Form -->
    <div id="login-page" class="auth-container">
        <h2>Login</h2>
        <form id="login-form">
            <div class="form-group">
                <label for="login-email">Email</label>
                <input type="email" id="login-email" required placeholder="user@example.com">
            </div>
            <div class="form-group">
                <label for="login-password">Password</label>
                <input type="password" id="login-password" required placeholder="Enter password">
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="remember-me">
                    Remember me
                </label>
            </div>
            <button type="submit" id="login-button">Sign In</button>
            <div id="login-error" class="error hidden"></div>
        </form>
        
        <p style="margin-top: 20px; text-align: center;">
            <a href="#" id="forgot-password">Forgot Password?</a> | 
            <a href="#" id="create-account">Create Account</a>
        </p>
    </div>
    
    <!-- MFA Page -->
    <div id="mfa-page" class="auth-container hidden">
        <h2>Two-Factor Authentication</h2>
        <p>Enter the 6-digit code from your authenticator app</p>
        <form id="mfa-form">
            <div class="form-group">
                <input type="text" id="mfa-code" maxlength="6" pattern="[0-9]{6}" 
                       placeholder="000000" style="text-align: center; font-size: 24px;">
            </div>
            <button type="submit" id="verify-mfa">Verify Code</button>
            <div id="mfa-error" class="error hidden"></div>
        </form>
        
        <p style="margin-top: 20px; text-align: center;">
            <a href="#" id="use-backup-code">Use backup code</a>
        </p>
    </div>
    
    <!-- Redirect/Interstitial Page -->
    <div id="redirect-page" class="auth-container hidden">
        <h2>Redirecting...</h2>
        <div class="redirect-message">
            <p>Login successful! Redirecting to dashboard...</p>
            <div style="margin: 20px 0;">
                <div style="width: 100%; background: #e0e0e0; height: 4px; border-radius: 2px;">
                    <div id="progress-bar" style="width: 0%; background: #2196f3; height: 100%; border-radius: 2px; transition: width 3s;"></div>
                </div>
            </div>
            <p>If you are not redirected, <a href="#" id="manual-redirect">click here</a></p>
        </div>
    </div>
    
    <!-- Dashboard (post-login) -->
    <div id="dashboard-page" class="auth-container hidden">
        <h2>Welcome to Dashboard</h2>
        <div class="success">You are successfully logged in!</div>
        <div style="margin: 30px 0;">
            <p>User: <strong id="user-email">user@example.com</strong></p>
            <p>Session: <strong id="session-id">ABC123XYZ</strong></p>
        </div>
        <button id="logout-button">Logout</button>
    </div>
    
    <!-- Password Reset -->
    <div id="reset-page" class="auth-container hidden">
        <h2>Reset Password</h2>
        <form id="reset-form">
            <div class="form-group">
                <label for="reset-email">Enter your email</label>
                <input type="email" id="reset-email" required placeholder="user@example.com">
            </div>
            <button type="submit" id="send-reset">Send Reset Link</button>
            <div id="reset-message" class="success hidden">Reset link sent to your email!</div>
        </form>
        
        <p style="margin-top: 20px; text-align: center;">
            <a href="#" id="back-to-login">Back to Login</a>
        </p>
    </div>
    
    <script>
        // Simulated auth flow
        let currentPage = 'login';
        
        function showPage(pageId) {
            document.querySelectorAll('.auth-container').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById(pageId + '-page').classList.remove('hidden');
            currentPage = pageId;
        }
        
        // Login form submission
        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // Simulate validation
            if (email && password) {
                // Simulate MFA requirement for certain users
                if (email.includes('admin')) {
                    showPage('mfa');
                } else {
                    // Show redirect page
                    showPage('redirect');
                    startRedirect();
                }
            } else {
                document.getElementById('login-error').textContent = 'Invalid credentials';
                document.getElementById('login-error').classList.remove('hidden');
            }
        });
        
        // MFA verification
        document.getElementById('mfa-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const code = document.getElementById('mfa-code').value;
            
            if (code === '123456') {
                showPage('redirect');
                startRedirect();
            } else {
                document.getElementById('mfa-error').textContent = 'Invalid code';
                document.getElementById('mfa-error').classList.remove('hidden');
            }
        });
        
        // Redirect simulation
        function startRedirect() {
            const progressBar = document.getElementById('progress-bar');
            progressBar.style.width = '100%';
            
            setTimeout(() => {
                showPage('dashboard');
                // Update dashboard with user info
                const email = document.getElementById('login-email').value;
                document.getElementById('user-email').textContent = email;
                document.getElementById('session-id').textContent = 
                    'SES' + Math.random().toString(36).substr(2, 9).toUpperCase();
            }, 3000);
        }
        
        // Navigation handlers
        document.getElementById('forgot-password').addEventListener('click', (e) => {
            e.preventDefault();
            showPage('reset');
        });
        
        document.getElementById('back-to-login').addEventListener('click', (e) => {
            e.preventDefault();
            showPage('login');
        });
        
        document.getElementById('manual-redirect').addEventListener('click', (e) => {
            e.preventDefault();
            showPage('dashboard');
        });
        
        document.getElementById('logout-button').addEventListener('click', () => {
            showPage('login');
            // Clear form
            document.getElementById('login-form').reset();
        });
        
        // Password reset
        document.getElementById('reset-form').addEventListener('submit', (e) => {
            e.preventDefault();
            document.getElementById('reset-message').classList.remove('hidden');
            setTimeout(() => {
                showPage('login');
            }, 2000);
        });
    </script>
</body>
</html>